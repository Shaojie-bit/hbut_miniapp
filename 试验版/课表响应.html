<!DOCTYPE html>

<!DOCTYPE html>
<html style="overflow-x:auto;overflow-y:auto;">

<head>
    <title>学生课表-Powered by ChaoXing</title>

    <!DOCTYPE html>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="keywords" content="湖北工业大学综合教务管理系统">
    <meta name="description" content="湖北工业大学综合教务管理系统">

    <link rel="shortcut icon"
        href="/admin/system/attachment/showImage/9df8ff9f48dc41cba17ae3c690b6af87?_t=1768304087387">
    <link href="/static/vendors/bootstrap/css/bootstrap.min.css?_t=1768304087387" rel="stylesheet">
    <link href="/static/vendors/font-awesome/css/font-awesome.min.css?_t=1768304087387" rel="stylesheet">
    <link href="/static/vendors/animate/css/animate.css?_t=1768304087387" rel="stylesheet">
    <link type="text/css" rel="stylesheet" href="/static/vendors/iCheck/skins/all.css?_t=1768304087387">
    <link href="/static/vendors/datepicker/datepicker3.css?_t=1768304087387" rel="stylesheet">
    <!-- jqgrid-->
    <link href="/static/vendors/jqgrid/css/ui.jqgrid-bootstrap.css?_t=1768304087387" rel="stylesheet">
    <!-- Sweet Alert -->
    <link href="/static/vendors/sweetalert/sweetalert.css?_t=1768304087387" rel="stylesheet">
    <!-- jquery-ui -->
    <link type="text/css" rel="stylesheet"
        href="/static/vendors/jquery-ui-1.10.4.custom/css/ui-lightness/jquery-ui-1.14.0.custom.min.css?_t=1768304087387" />


    <!-- 由于使用了自定义标签，jquery必须在之前 -->
    <!-- 全局js -->
    <script src="/static/vendors/jquery/js/jquery.min.js?_t=1768304087387"></script>
    <script src="/static/common/js/prototype.js?_t=1768304087387"></script>
    <script src="/static/common/js/func.js?_t=1768304087387"></script>
    <script src="/static/vendors/jquery-ui/jquery-ui.min.js?_t=1768304087387"></script>



    <link href="/static/common/css/style.css?_t=1768304087387" rel="stylesheet">


    <script src="/static/common/demo/imgViewer/js/imgView.js?_t=1768304087387"></script>
    <link rel="stylesheet" type="text/css" href="/static/common/demo/imgViewer/css/style.css?_t=1768304087387" />


    <meta name="decorator" content="list" />

    <script src="/static/common/js/utils.js?_t=1768304087387"></script>
    <script type="text/javascript" src="/static/pkgl/pkglUtils.js?_t=1768304087387"></script>
    <script>
        var jwUtils = new JwUtils();
        let urlXnxq = jwUtils.getUrlParam('xnxq')
        if (!urlXnxq) {
            urlXnxq = "2025-2026-1"
            location.href = location.pathname + '?xnxq=' + urlXnxq
        }
    </script>
    <style>
        .thtext {
            width: 100px;
            text-align: center;
        }

        hr {
            height: 1px;
            border: none;
            border-top: 1px solid #999;
            margin: 2px;
        }

        .cell {
            height: 80px;
            text-align: center;
        }

        .div1 {
            display: inline;
        }

        .div2 {
            display: inline;
            float: right;
        }

        /* 添加不同时间段的背景色 */
        .time-zs {
            /* 早上 */
            background-color: #E8FAF9;
        }

        .time-sw {
            /* 上午 */
            background-color: #F5FFF0;
        }

        .time-zw {
            /* 中午 */
            background-color: #FFFCEB;
        }

        .time-xw {
            /* 下午 */
            background-color: #FFF3ED;
        }

        .time-bw {
            /* 傍晚 */
            background-color: #EFF8FE;
        }

        .time-ws {
            /* 晚上 */
            background-color: #F8F1FE;
        }
    </style>
    <style>
        .table-bordered>thead>tr>th,
        .table-bordered>tbody>tr>th,
        .table-bordered>tfoot>tr>th,
        .table-bordered>thead>tr>td,
        .table-bordered>tbody>tr>td,
        .table-bordered>tfoot>tr>td {
            border: 2px solid #ccc;
        }
    </style>

    <style>
        .dropload-up,
        .dropload-down {
            position: relative;
            height: 0;
            overflow: hidden;
            font-size: 12px;
            /* 开启硬件加速 */
            -webkit-transform: translateZ(0);
            transform: translateZ(0);
        }

        .dropload-down {
            height: 50px;
        }

        .dropload-refresh,
        .dropload-update,
        .dropload-load,
        .dropload-noData {
            line-height: 50px;
            text-align: center;
        }

        .dropload-load .loading {
            display: inline-block;
            height: 15px;
            width: 15px;
            border-radius: 100%;
            margin: 6px;
            border: 2px solid #666;
            border-bottom-color: transparent;
            vertical-align: middle;
            -webkit-animation: rotate 0.75s linear infinite;
            animation: rotate 0.75s linear infinite;
        }

        @-webkit-keyframes rotate {
            0% {
                -webkit-transform: rotate(0deg);
            }

            50% {
                -webkit-transform: rotate(180deg);
            }

            100% {
                -webkit-transform: rotate(360deg);
            }
        }

        @keyframes rotate {
            0% {
                transform: rotate(0deg);
            }

            50% {
                transform: rotate(180deg);
            }

            100% {
                transform: rotate(360deg);
            }
        }
    </style>
    <script src="/static/js/xkgl/dropload.min.js?_t=1768304087387"></script>
    <script>
        $(function () {
            $(".gohome").hide();
            $('#downOrUpRefresh').bind({
                scrollArea: window,
                domUp: {
                    domClass: 'dropload-up',
                    domRefresh: '<div class="dropload-refresh">下拉刷新</div>',
                    domUpdate: '<div class="dropload-update">释放刷新</div>'
                },
                loadUpFn: function (me) {
                    window.location.reload(true);
                },
                threshold: 50
            });
        });
    </script>
</head>

<body class="gray-bg">
    <div class="wrapper wrapper-content animated fadeInRight">
        <div class="row">
            <div class="col-sm-12">
                <div class="ibox float-e-margins">
                    <div class="ibox-title" id="downOrUpRefresh" style="">
                        <h5></h5>
                        <!-- 列表表头ibox-tools的工具，隐藏，20171212 -->
                        <!-- <div class="ibox-tools">
                        <a class="collapse-link"> <i class="fa fa-chevron-up"></i>
                        </a>
                        <a class="close-link"> <i class="fa fa-times"></i>
                        </a>
                    </div> -->
                    </div>
                    <div class="ibox-content">

                        <input type="hidden" id="xnxq" value="2025-2026-1">
                        <input type="hidden" id="xhid"
                            value="WGEyQ0DB6593E5339A327F2DFAFB7173A79BBC44B15CDCDEB7C726DAA7FEB49D1C125AC200B73B46567C78">
                        <input type="hidden" id="xqdm" value="1">
                        <input type="hidden" id="kbxjxsmc" value="1" />
                        <input type="hidden" id="sfxsjxlmc" value="0" />



                        <div class="row">

                            <div class="col-sm-12" id="errorDiv" style="display: none;">
                                <div class="alert alert-danger">
                                    <button aria-hidden="true" data-dismiss="alert" class="close"
                                        type="button"></button>
                                    提示：<span id="error"></span>
                                </div>
                            </div>
                            <div class="col-sm-12" id="warningDiv" style="display: none;margin-top: 5px;">
                                <div class="alert alert-warning">
                                    <button aria-hidden="true" data-dismiss="alert" class="close"
                                        type="button"></button>
                                    提示：<span id="warning"></span>
                                </div>
                            </div>
                            <div class="form-inline">
                                <span id="xnxq" hidden="true">2025-2026-1</span>
                                <div class="form-group col-md-4" style="margin-bottom: 10px">
                                    <label class="control-label">学年学期：</label>
                                    <select name="xnxq" class="form-control" id="xnxq1">
                                        <option value="">请选择</option>

                                        <option value="2025-2026-1" selected>2025-2026-1</option>

                                        <option value="2024-2025-2">2024-2025-2</option>

                                        <option value="2024-2025-1">2024-2025-1</option>

                                        <option value="2023-2024-2">2023-2024-2</option>

                                        <option value="2023-2024-1">2023-2024-1</option>

                                        <option value="2022-2023-2">2022-2023-2</option>

                                        <option value="2022-2023-1">2022-2023-1</option>

                                        <option value="2021-2022-2">2021-2022-2</option>

                                        <option value="2021-2022-1">2021-2022-1</option>

                                    </select>
                                </div>
                                <div class="form-group col-md-4" style="margin-bottom: 10px">
                                    <label class="control-label">上课校区：</label>
                                    <select class="form-control" id="xqSelect" name="campusSelect"
                                        onchange="onCampusChange(this)"></select>
                                </div>
                                <div class="form-group col-md-4" style="margin-bottom: 10px">
                                    <label class="control-label">周次：</label>
                                    <div class="form-control" name="zc">
                                        <input type="number" min="0" id="zxzc" name="zxzc" size="1" rows="1" cols="1"
                                            class="half" value="" />
                                        <input type="number" min="0" id="zdzc" name="zdzc" size="1" rows="1" cols="1"
                                            class="half" value="" />
                                    </div>
                                </div>

                                <div class="form-group col-md-4" style="margin-bottom: 10px">
                                    <input id="volume" type="range" min="0" max="200" value="100"
                                        onchange="changeTableSize(this)"
                                        style="float: left;width:45%;margin-top:10px;margin-right: 20px;">
                                    <button class="btn btn-sm btn btn-sm btn-primary" id="printId"
                                        onclick="exportExcel('打印','/admin/pkgl/xskb/reportforxskb','xskbGridIdGrid','800px','500px')"><i
                                            class="fa "></i> 打印</button>
                                </div>

                            </div>
                        </div>
                        <hr>
                        <div style="width: 100%;text-align: center;font-weight: bold;font-size: 16px;">
                            <font>2025-2026学年第1学期王少杰的课表</font>

                            <p class="currentWeek" style="color: #00C297;">当前周次：第<span></span>周</p>

                        </div>


                        <div id="pageBody" style="width: 100%;overflow: auto;padding-bottom: 24px">
                            <div id="dataForm">


                                <script type="text/javascript">
                                    var zjcArray = new Array();
                                </script>

                                <script type="text/javascript">
                                    var obj = new Object();
                                    obj.xqid = '';
                                    obj.zjc = 12;
                                    zjcArray.push(obj);
                                </script>



                                <table id="" data-fixed-columns="true" data-fixed-number="1" width="95%" align="center"
                                    class="table-bordered" style="" border="1" style="border-collapse:collapse;">
                                    <thead>
                                        <div id="mc" style="width: 100%">
                                            <b>
                                                <font></font>
                                            </b>
                                        </div>
                                        <tr>
                                            <th class="active text-right" style="width:80px">
                                            </th>
                                            <th class="thtext">节次</th>

                                            <th class="thtext sundayFirst">星期日</th>

                                            <th class="thtext">星期一</th>
                                            <th class="thtext">星期二</th>
                                            <th class="thtext">星期三</th>
                                            <th class="thtext">星期四</th>
                                            <th class="thtext">星期五</th>

                                            <th class="thtext">星期六</th>

                                            <th class="thtext mondayFirst">星期日</th>


                                        </tr>
                                    </thead>
                                    <tbody>

                                        <tr>



                                            <td class="time-sw" rowspan="4">
                                                上午
                                            </td>







                                            <td style="text-align: center;" id="Cell01" class="time-sw">
                                                1(1~2)[08:20~09:55]</td>



                                            <td class="cell sundayFirst" id="Cell71" sid="1(1~2)[08:20~09:55]"></td>

                                            <td class="cell" id="Cell11" sid="1(1~2)[08:20~09:55]"></td>
                                            <td class="cell" id="Cell21" sid="1(1~2)[08:20~09:55]"></td>
                                            <td class="cell" id="Cell31" sid="1(1~2)[08:20~09:55]"></td>
                                            <td class="cell" id="Cell41" sid="1(1~2)[08:20~09:55]"></td>
                                            <td class="cell" id="Cell51" sid="1(1~2)[08:20~09:55]"></td>

                                            <td class="cell" id="Cell61" sid="1(1~2)[08:20~09:55]"></td>

                                            <td class="cell mondayFirst" id="Cell71" sid="1(1~2)[08:20~09:55]"></td>


                                        </tr>

                                        <tr>









                                            <td style="text-align: center;" id="Cell02" class="time-sw">
                                                1(1~2)[08:20~09:55]</td>



                                            <td class="cell sundayFirst" id="Cell72" sid="1(1~2)[08:20~09:55]"></td>

                                            <td class="cell" id="Cell12" sid="1(1~2)[08:20~09:55]"></td>
                                            <td class="cell" id="Cell22" sid="1(1~2)[08:20~09:55]"></td>
                                            <td class="cell" id="Cell32" sid="1(1~2)[08:20~09:55]"></td>
                                            <td class="cell" id="Cell42" sid="1(1~2)[08:20~09:55]"></td>
                                            <td class="cell" id="Cell52" sid="1(1~2)[08:20~09:55]"></td>

                                            <td class="cell" id="Cell62" sid="1(1~2)[08:20~09:55]"></td>

                                            <td class="cell mondayFirst" id="Cell72" sid="1(1~2)[08:20~09:55]"></td>


                                        </tr>

                                        <tr>









                                            <td style="text-align: center;" id="Cell03" class="time-sw">
                                                2(3~4)[10:15~11:50]</td>



                                            <td class="cell sundayFirst" id="Cell73" sid="2(3~4)[10:15~11:50]"></td>

                                            <td class="cell" id="Cell13" sid="2(3~4)[10:15~11:50]"></td>
                                            <td class="cell" id="Cell23" sid="2(3~4)[10:15~11:50]"></td>
                                            <td class="cell" id="Cell33" sid="2(3~4)[10:15~11:50]"></td>
                                            <td class="cell" id="Cell43" sid="2(3~4)[10:15~11:50]"></td>
                                            <td class="cell" id="Cell53" sid="2(3~4)[10:15~11:50]"></td>

                                            <td class="cell" id="Cell63" sid="2(3~4)[10:15~11:50]"></td>

                                            <td class="cell mondayFirst" id="Cell73" sid="2(3~4)[10:15~11:50]"></td>


                                        </tr>

                                        <tr>









                                            <td style="text-align: center;" id="Cell04" class="time-sw">
                                                2(3~4)[10:15~11:50]</td>



                                            <td class="cell sundayFirst" id="Cell74" sid="2(3~4)[10:15~11:50]"></td>

                                            <td class="cell" id="Cell14" sid="2(3~4)[10:15~11:50]"></td>
                                            <td class="cell" id="Cell24" sid="2(3~4)[10:15~11:50]"></td>
                                            <td class="cell" id="Cell34" sid="2(3~4)[10:15~11:50]"></td>
                                            <td class="cell" id="Cell44" sid="2(3~4)[10:15~11:50]"></td>
                                            <td class="cell" id="Cell54" sid="2(3~4)[10:15~11:50]"></td>

                                            <td class="cell" id="Cell64" sid="2(3~4)[10:15~11:50]"></td>

                                            <td class="cell mondayFirst" id="Cell74" sid="2(3~4)[10:15~11:50]"></td>


                                        </tr>

                                        <tr>





                                            <td class="time-xw" rowspan="4">
                                                下午
                                            </td>





                                            <td style="text-align: center;" id="Cell05" class="time-xw">
                                                3(5~6)[14:00~15:35]</td>



                                            <td class="cell sundayFirst" id="Cell75" sid="3(5~6)[14:00~15:35]"></td>

                                            <td class="cell" id="Cell15" sid="3(5~6)[14:00~15:35]"></td>
                                            <td class="cell" id="Cell25" sid="3(5~6)[14:00~15:35]"></td>
                                            <td class="cell" id="Cell35" sid="3(5~6)[14:00~15:35]"></td>
                                            <td class="cell" id="Cell45" sid="3(5~6)[14:00~15:35]"></td>
                                            <td class="cell" id="Cell55" sid="3(5~6)[14:00~15:35]"></td>

                                            <td class="cell" id="Cell65" sid="3(5~6)[14:00~15:35]"></td>

                                            <td class="cell mondayFirst" id="Cell75" sid="3(5~6)[14:00~15:35]"></td>


                                        </tr>

                                        <tr>









                                            <td style="text-align: center;" id="Cell06" class="time-xw">
                                                3(5~6)[14:00~15:35]</td>



                                            <td class="cell sundayFirst" id="Cell76" sid="3(5~6)[14:00~15:35]"></td>

                                            <td class="cell" id="Cell16" sid="3(5~6)[14:00~15:35]"></td>
                                            <td class="cell" id="Cell26" sid="3(5~6)[14:00~15:35]"></td>
                                            <td class="cell" id="Cell36" sid="3(5~6)[14:00~15:35]"></td>
                                            <td class="cell" id="Cell46" sid="3(5~6)[14:00~15:35]"></td>
                                            <td class="cell" id="Cell56" sid="3(5~6)[14:00~15:35]"></td>

                                            <td class="cell" id="Cell66" sid="3(5~6)[14:00~15:35]"></td>

                                            <td class="cell mondayFirst" id="Cell76" sid="3(5~6)[14:00~15:35]"></td>


                                        </tr>

                                        <tr>









                                            <td style="text-align: center;" id="Cell07" class="time-xw">
                                                4(7~8)[15:55~17:30]</td>



                                            <td class="cell sundayFirst" id="Cell77" sid="4(7~8)[15:55~17:30]"></td>

                                            <td class="cell" id="Cell17" sid="4(7~8)[15:55~17:30]"></td>
                                            <td class="cell" id="Cell27" sid="4(7~8)[15:55~17:30]"></td>
                                            <td class="cell" id="Cell37" sid="4(7~8)[15:55~17:30]"></td>
                                            <td class="cell" id="Cell47" sid="4(7~8)[15:55~17:30]"></td>
                                            <td class="cell" id="Cell57" sid="4(7~8)[15:55~17:30]"></td>

                                            <td class="cell" id="Cell67" sid="4(7~8)[15:55~17:30]"></td>

                                            <td class="cell mondayFirst" id="Cell77" sid="4(7~8)[15:55~17:30]"></td>


                                        </tr>

                                        <tr>









                                            <td style="text-align: center;" id="Cell08" class="time-xw">
                                                4(7~8)[15:55~17:30]</td>



                                            <td class="cell sundayFirst" id="Cell78" sid="4(7~8)[15:55~17:30]"></td>

                                            <td class="cell" id="Cell18" sid="4(7~8)[15:55~17:30]"></td>
                                            <td class="cell" id="Cell28" sid="4(7~8)[15:55~17:30]"></td>
                                            <td class="cell" id="Cell38" sid="4(7~8)[15:55~17:30]"></td>
                                            <td class="cell" id="Cell48" sid="4(7~8)[15:55~17:30]"></td>
                                            <td class="cell" id="Cell58" sid="4(7~8)[15:55~17:30]"></td>

                                            <td class="cell" id="Cell68" sid="4(7~8)[15:55~17:30]"></td>

                                            <td class="cell mondayFirst" id="Cell78" sid="4(7~8)[15:55~17:30]"></td>


                                        </tr>

                                        <tr>







                                            <td class="time-ws" rowspan="3">
                                                晚上
                                            </td>



                                            <td style="text-align: center;" id="Cell09" class="time-ws">
                                                5(9~11)[18:30~20:55]</td>



                                            <td class="cell sundayFirst" id="Cell79" sid="5(9~11)[18:30~20:55]"></td>

                                            <td class="cell" id="Cell19" sid="5(9~11)[18:30~20:55]"></td>
                                            <td class="cell" id="Cell29" sid="5(9~11)[18:30~20:55]"></td>
                                            <td class="cell" id="Cell39" sid="5(9~11)[18:30~20:55]"></td>
                                            <td class="cell" id="Cell49" sid="5(9~11)[18:30~20:55]"></td>
                                            <td class="cell" id="Cell59" sid="5(9~11)[18:30~20:55]"></td>

                                            <td class="cell" id="Cell69" sid="5(9~11)[18:30~20:55]"></td>

                                            <td class="cell mondayFirst" id="Cell79" sid="5(9~11)[18:30~20:55]"></td>


                                        </tr>

                                        <tr>









                                            <td style="text-align: center;" id="Cell010" class="time-ws">
                                                5(9~11)[18:30~20:55]</td>



                                            <td class="cell sundayFirst" id="Cell710" sid="5(9~11)[18:30~20:55]"></td>

                                            <td class="cell" id="Cell110" sid="5(9~11)[18:30~20:55]"></td>
                                            <td class="cell" id="Cell210" sid="5(9~11)[18:30~20:55]"></td>
                                            <td class="cell" id="Cell310" sid="5(9~11)[18:30~20:55]"></td>
                                            <td class="cell" id="Cell410" sid="5(9~11)[18:30~20:55]"></td>
                                            <td class="cell" id="Cell510" sid="5(9~11)[18:30~20:55]"></td>

                                            <td class="cell" id="Cell610" sid="5(9~11)[18:30~20:55]"></td>

                                            <td class="cell mondayFirst" id="Cell710" sid="5(9~11)[18:30~20:55]"></td>


                                        </tr>

                                        <tr>









                                            <td style="text-align: center;" id="Cell011" class="time-ws">
                                                5(9~11)[18:30~20:55]</td>



                                            <td class="cell sundayFirst" id="Cell711" sid="5(9~11)[18:30~20:55]"></td>

                                            <td class="cell" id="Cell111" sid="5(9~11)[18:30~20:55]"></td>
                                            <td class="cell" id="Cell211" sid="5(9~11)[18:30~20:55]"></td>
                                            <td class="cell" id="Cell311" sid="5(9~11)[18:30~20:55]"></td>
                                            <td class="cell" id="Cell411" sid="5(9~11)[18:30~20:55]"></td>
                                            <td class="cell" id="Cell511" sid="5(9~11)[18:30~20:55]"></td>

                                            <td class="cell" id="Cell611" sid="5(9~11)[18:30~20:55]"></td>

                                            <td class="cell mondayFirst" id="Cell711" sid="5(9~11)[18:30~20:55]"></td>


                                        </tr>

                                        <tr>
                                            <th class="active text-center ">
                                                <label>备注</label>
                                            </th>
                                            <td colspan="8">




                                                实践环节：


                                                学科竞赛培训实践1；


                                                陈本源；








                                                17-18周；





                                                学科竞赛培训实践1【环节】1630；


                                                23微电子1,23微电子2,23微电子3；


                                                123人；


                                                </br>


                                                实践环节：


                                                学科竞赛培训实践1；


                                                李劲；








                                                17-18周；





                                                学科竞赛培训实践1【环节】1630；


                                                23微电子1,23微电子2,23微电子3；


                                                123人；


                                                </br>


                                                实践环节：


                                                学科竞赛培训实践1；


                                                范金虎；








                                                17-18周；





                                                学科竞赛培训实践1【环节】1630；


                                                23微电子1,23微电子2,23微电子3；


                                                123人；


                                                </br>


                                                实践环节：


                                                学科竞赛培训实践1；


                                                徐斌；








                                                17-18周；





                                                学科竞赛培训实践1【环节】1630；


                                                23微电子1,23微电子2,23微电子3；


                                                123人；


                                                </br>


                                                实践环节：


                                                学科竞赛培训实践1；


                                                成纯富；








                                                17-18周；





                                                学科竞赛培训实践1【环节】1630；


                                                23微电子1,23微电子2,23微电子3；


                                                123人；


                                                </br>


                                                实践环节：


                                                学科竞赛培训实践1；


                                                江俊帮；








                                                17-18周；





                                                学科竞赛培训实践1【环节】1630；


                                                23微电子1,23微电子2,23微电子3；


                                                123人；


                                                </br>


                                                实践环节：


                                                学科竞赛培训实践1；


                                                邹维；








                                                17-18周；





                                                学科竞赛培训实践1【环节】1630；


                                                23微电子1,23微电子2,23微电子3；


                                                123人；


                                                </br>


                                                实践环节：


                                                短学期实践5；


                                                罗山梦黛；








                                                20-21周；





                                                短学期实践5【环节】5818；


                                                23微电子2；


                                                41人；


                                                </br>


                                                <div id="zxmtBzText"></div>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                                <br>

                            </div>
                        </div>

                        <script type="text/javascript">
                            // isAllow = -1 代表没有权限查看。
                            var isAllow = "";
                            var isShowJxl = $('#sfxsjxlmc').val() == '1' ? true : false; // 是否显示教学楼名称
                            var zxmtBzText = ""; // 自修课程、免听课程备注
                            // 湖工获取当前周次显示
                            function getCurrentWeek() {
                                const weekNumDom = $('.currentWeek').find('span')
                                if (weekNumDom) {
                                    $.ajax({
                                        url: '/admin/api/getXlzc',
                                        method: 'get',
                                        success: function (resp) {
                                            if (resp.ret == 0) {
                                                weekNumDom.text(resp.data.xlzc)
                                            }
                                        }
                                    })

                                }
                            }
                            getCurrentWeek()
                            function changeTableSize(_this) {
                                var size = $(_this).val() / 100;
                                if (size == 0) {
                                    size = 0.0001
                                }
                                $("#dataForm").css("zoom", size);
                            }
                            function getbzxx() {
                                var xnxq = $('#xnxq').val();
                                var xhid = $('#xhid').val();
                                $.ajax({
                                    type: "post",
                                    url: "/admin/pkgl/xskb/getbzxx",
                                    data: { xnxq: xnxq, xhid },
                                    dataType: "json",
                                    async: false,
                                    success: function (res) {
                                        zxmtBzText = res.data.join('<br>')
                                        $("#zxmtBzText").html(zxmtBzText)
                                    }
                                })
                            }

                            var idArr = [];
                            var xq = new Array();
                            //校验是否可查
                            function checkKc(xnxq) {
                                var bl = true;
                                $.ajax({
                                    type: "post",
                                    url: "/admin/xsd/kcapcx/checkSfkc",
                                    data: { xnxq: xnxq, type: "1" },
                                    dataType: "json",
                                    async: false,
                                    success: function (data) {
                                        if (data.ret == 0) {
                                            $("#errorDiv").hide();
                                        } else {
                                            $("#errorDiv").show();
                                            $("#error").text(data.msg);
                                            bl = false;
                                        }
                                    }
                                });
                                return bl;
                            }
                            var dbname = "hbut"
                            var isDaJieDisplay = "true"
                            var showKbxsjcsj = "true"

                            // #52195 天津财经按大节显示，格式化节次名称
                            function formatJcName() {
                                if (!['tjcj'].includes(dbname)) {
                                    return
                                }
                                // 是否按大节显示
                                if (isDaJieDisplay === 'false') {
                                    return
                                }

                                let jcIdStr = '';


                                jcIdStr += '#Cell01,';

                                jcIdStr += '#Cell02,';

                                jcIdStr += '#Cell03,';

                                jcIdStr += '#Cell04,';

                                jcIdStr += '#Cell05,';

                                jcIdStr += '#Cell06,';

                                jcIdStr += '#Cell07,';

                                jcIdStr += '#Cell08,';

                                jcIdStr += '#Cell09,';

                                jcIdStr += '#Cell010,';

                                jcIdStr += '#Cell011,';



                                let jcids = jcIdStr.slice(0, -1).split(',');
                                jcids.forEach(jcId => {
                                    let jcStr = $(jcId).html();
                                    if (jcStr) {
                                        jcStr = jcStr.slice(0, -1) + '小节)';
                                        let leftBracketIdx = jcStr.indexOf("(");
                                        let leftString = jcStr.slice(0, leftBracketIdx);
                                        let rightString = jcStr.slice(leftBracketIdx);
                                        $(jcId).html('第' + jwUtils.convertToChinaNum(leftString) + '大节<br/>' + rightString);
                                    }
                                })

                            }

                            var kbjcObj = {}
                            var xqid = ''
                            function onCampusChange(selectElement) {
                                xqid = selectElement.value;
                                getZclistByXnxq()
                            }
                            function getZclistByXnxq() {
                                let xnxq = $("#xnxq").val()
                                $.ajax({
                                    type: "get",
                                    url: "/admin/api/getZclistByXnxq",
                                    data: { xnxq: xnxq, role: '', userId: '', xqid: xqid },
                                    dataType: "json",
                                    async: false,
                                    success: function (res) {
                                        if (res.ret == 0) {
                                            kbjcObj = res.data
                                            displayJcTime()
                                        } else {
                                            console.error('getZclistByXnxq error', res.msg);
                                        }
                                    },
                                    error: function (data) {
                                        console.error('getZclistByXnxq error');
                                    }
                                })
                            }
                            // 节次显示具体时间
                            function displayJcTime() {
                                // 是否按大节显示
                                if (isDaJieDisplay === 'true') {
                                    return
                                }
                                let pageJcsjszList = kbjcObj.jcsjszList || [];
                                // 1:显示小节 2：显示小节别名
                                let kbxjxsmc = $('#kbxjxsmc').val() == '2' ? true : false
                                pageJcsjszList.forEach((jcsz, i) => {
                                    let jcIndex = i + 1
                                    let str = jcsz.jcbm && kbxjxsmc ? jcsz.jcbm : i + 1
                                    let kssj = jcsz.kssj ? '<br />' + jcsz.kssj : ''
                                    let jssj = jcsz.jssj ? '<br />' + jcsz.jssj : ''
                                    // 课表显示节次时间
                                    if ((kssj || jssj) && showKbxsjcsj !== 'false') {
                                        $(`td[data-jcIndex=${jcIndex}]`).html(str + '<span style="font-size: 12px;font-weight:200;">' + kssj + jssj + '</span>')
                                    } else {
                                        $(`td[data-jcIndex=${jcIndex}]`).html(str)
                                    }
                                })
                            }
                            // 导航切换函数
                            function changeTab(type) {
                                // 获取参数值
                                const xnxq = $("#xnxq1").val();
                                const zxzc = $("#zxzc").val();
                                const zdzc = $("#zdzc").val();
                                console.log(type, 'type');

                                // 拼接URL
                                const baseUrl = '/admin/pkgl/xskb/queryKbForXsd';
                                const params = `?xnxq=2025-2026-1&zxzc=&zdzc=&xskbxslx=` + type;

                                console.log(params, 'params');
                                // 跳转页面
                                location.href = baseUrl + params;
                            }
                            const currentType = new URLSearchParams(location.search).get('xskbxslx') || 0;
                            $(function () {
                                $('.nav-tabs li').removeClass('active');
                                if (currentType != 0) {
                                    $('#printId').hide()
                                }
                                $(`#kb-` + currentType).addClass('active');
                            });

                            function checkSfPj(xnxq) {
                                var bl = true;
                                $.ajax({
                                    type: "post",
                                    url: "/admin/xsd/pkgl/xskb/checkWfwSfpj",
                                    data: { xnxq: xnxq },
                                    dataType: "json",
                                    async: false,
                                    success: function (data) {
                                        if (data.ret == 0) {
                                            $("#errorDiv").hide();
                                        } else if (data.ret == 1) {
                                            $("#warningDiv").show();
                                            $("#printId").hide()
                                            $("#warning").text(data.msg);
                                            bl = false;
                                        } else if (data.ret == -1) {
                                            $("#warningDiv").show();
                                            $("#printId").hide()
                                            $("#warning").html('未获取到评教数据，无法查看课表，可点击<a style="color:#2AA0F5;text-decoration:none;margin:0 3px;"  onclick="location.reload()">刷新</a>重试。');
                                            bl = false;
                                        }
                                    }
                                });
                                return bl;
                            }

                            function getXqList() {
                                $.ajax({
                                    type: "get",
                                    url: "/admin/api/jcsj/xqsj/getXqList",
                                    dataType: "json",
                                    async: false,
                                    success: function (res) {
                                        if (res.ret == 0) {
                                            console.log(res, "res");
                                            var selectElement = $('#xqSelect');
                                            // 清空原有的选项
                                            selectElement.empty();
                                            // 遍历返回的数据并添加到下拉列表
                                            $.each(res.data, function (index, item) {
                                                var option = $('<option>', {
                                                    value: item.id,
                                                    text: item.xqmc
                                                });
                                                selectElement.append(option);
                                            });
                                            // 设置默认选中的值
                                            let defaultXqdm = $('#xqdm').val();
                                            selectElement.val(defaultXqdm);
                                            // 触发 change 事件，以便页面上的其他逻辑可以响应变化
                                            selectElement.trigger('change');
                                        } else {
                                            console.error('getXqList error', res.msg);
                                        }
                                    },
                                    error: function (data) {
                                        console.error('getXqList error');
                                    }
                                })
                            }

                            // 获取是否周日显示在最前面
                            function getSundayFirst() {
                                return new Promise((resolve, reject) => {
                                    $.ajax({
                                        url: $("#adminPath").val() + '/api/getSetting',
                                        success: function (res) {
                                            if (res.ret == 0) {
                                                resolve(res.extend.SYSTEM_XLXSMZDYT == '7'); // 如果设置为7，则周日显示在最前面
                                            } else {
                                                resolve(false);
                                            }
                                        },
                                        error: function () {
                                            resolve(false);
                                        }
                                    });
                                });
                            }

                            // 渲染第一列的td
                            async function firstTdRender() {
                                let sundayFirst = await getSundayFirst();
                                if (sundayFirst) {
                                    // td 类名为 sundayFirst 展示出来， 类名为mondayFirst的隐藏
                                    $('.sundayFirst').show();
                                    $('.mondayFirst').remove();
                                } else {
                                    // td 类名为 mondayFirst 展示出来， 类名为sundayFirst的隐藏
                                    $('.mondayFirst').show();
                                    $('.sundayFirst').remove();
                                }
                            }

                            // 获取是否周日显示在最前面
                            function getSundayFirst() {
                                return new Promise((resolve, reject) => {
                                    $.ajax({
                                        url: $("#adminPath").val() + '/api/getSetting',
                                        success: function (res) {
                                            if (res.ret == 0) {
                                                resolve(res.extend.SYSTEM_XLXSMZDYT == '7'); // 如果设置为7，则周日显示在最前面
                                            } else {
                                                resolve(false);
                                            }
                                        },
                                        error: function () {
                                            resolve(false);
                                        }
                                    });
                                });
                            }

                            // 渲染第一列的td
                            async function firstTdRender() {
                                let sundayFirst = await getSundayFirst();
                                if (sundayFirst) {
                                    // td 类名为 sundayFirst 展示出来， 类名为mondayFirst的隐藏
                                    $('.sundayFirst').show();
                                    $('.mondayFirst').hide();
                                } else {
                                    // td 类名为 mondayFirst 展示出来， 类名为sundayFirst的隐藏
                                    $('.mondayFirst').show();
                                    $('.sundayFirst').hide();
                                }
                            }

                            $(document).ready(function () {
                                firstTdRender()
                                $("#dataForm").css("zoom", 1.2)
                                $("#volume").val(120)
                                getXqList(); // 渲染上课校区列表
                                formatJcName();
                                getbzxx()
                                getZclistByXnxq()
                                var xnxq = $('#xnxq').val();
                                var xhid = $('#xhid').val();
                                var xqdm = $('#xqdm').val();
                                if (xnxq != '') {
                                    var bl = checkKc(xnxq);
                                    if (!bl) {
                                        return false;
                                    }
                                    var bl1 = checkSfPj(xnxq);
                                    if (!bl1) {
                                        return false;
                                    }
                                } else {
                                    $("#errorDiv").hide();
                                }
                                $.ajax({
                                    url: '/admin/pkgl/xskb/sdpkkbList',
                                    data: {
                                        xnxq: xnxq,
                                        xhid: xhid,
                                        xqdm: xqdm,
                                        zdzc: $("#zdzc").val(),
                                        zxzc: $("#zxzc").val(),
                                        xskbxslx: currentType
                                    },
                                    success: function (data) {
                                        //清空上次数据
                                        for (var k = 0; k < idArr.length; k++) {
                                            $(idArr[k]).html("");
                                        }
                                        data = data.data || []
                                        if (data) {
                                            for (var i = 0; i < data.length; i++) {
                                                var o = data[i];
                                                //如果学区id数组里面没有该学区id，就塞进去
                                                //获取课程类型
                                                var kclx = "";

                                                if (o.type == 1) {
                                                    kclx = "（理论）";
                                                } else if (o.type == 2) {
                                                    kclx = "（实验）";
                                                } else if (o.type == 3) {
                                                    kclx = "（上机）";
                                                } else if (o.type == 4) {
                                                    kclx = "（实践）";
                                                } else if (o.type == 5) {
                                                    kclx = '（环节）';
                                                } else {
                                                    kclx = '（其他）';
                                                }


                                                var jxbmc = "";
                                                if (o.source == "3") {
                                                    jxbmc = o.jxbmc;
                                                }
                                                // 是否显示教学班学分
                                                var xf = ''

                                                // 是否显示教学班总学时
                                                var zongxs = ''


                                                //把信息拼成最终显示信息
                                                var content = (isEmpty(o.kcbh) ? "" : o.kcbh) + "<br>" + (isEmpty(o.xqmc) ? "" : o.xqmc) + "<br>" + (!isEmpty(o.xdxz) && '2' == o.xdxz ? "(重修)" : "") + o.kcmc + kclx + "<br>" + (isEmpty(o.tmc) ? "" : o.tmc) + "<br>" + (isEmpty(o.zcstr) ? "" : (o.zcstr + "周")) + "<br>" + (isEmpty(o.croommc) ? "" : o.croommc) + "<br>" + jxbmc + "<br>" + (isEmpty(o.ksxs) ? "" : o.ksxs) + "<br>" + (isEmpty(o.jxlmc) ? "" : o.jxlmc) + "<br>" + xf + "<br>" + zongxs + "<br>" + (isEmpty(o.remarks) ? "" : o.remarks) + "<br>" + "du123123";
                                                //定位到单元格
                                                var zhou = o.xingqi;//周几
                                                var jc = o.djc;//节次
                                                var xqid = o.xqid;//学区
                                                var idStr = "#Cell".concat(zhou, jc);

                                                //把显示信息拼到对应单元格上
                                                $(idStr).append("<br>");
                                                $(idStr).append(content);
                                            }

                                            for (var a = 1; a < 8; a++) {
                                                for (var b = 1; b < 21; b++) {
                                                    var cell = "#Cell".concat(a, b);
                                                    if ($(cell).html() != "" && $(cell).html() != undefined) {
                                                        //得到单元格内容

                                                        var contentArray = $(cell).html().split("du123123");
                                                        //得到单元格里面所有的课程
                                                        //创建一个带有状态码的对象数组
                                                        var courseArray = new Array();
                                                        for (var c = 0; c < contentArray.length - 1; c++) {
                                                            var course = contentArray[c];
                                                            //得到一门课里面的所有细节
                                                            var detail = course.split("<br>");
                                                            var obj = new Object();
                                                            for (var d = 1; d < detail.length - 1; d++) {
                                                                if (d == 1) {
                                                                    obj.kcbh = detail[d];
                                                                }
                                                                if (d == 2) {
                                                                    obj.xqmc = detail[d];
                                                                }
                                                                if (d == 3) {
                                                                    obj.kcmc = detail[d];
                                                                }
                                                                if (d == 4) {
                                                                    obj.tmc = detail[d];
                                                                }
                                                                if (d == 5) {
                                                                    obj.zc = detail[d];
                                                                }
                                                                if (d == 6) {
                                                                    obj.croommc = detail[d];
                                                                }
                                                                if (d == 7) {
                                                                    obj.jxbmc = detail[d];
                                                                }
                                                                if (d == 8) {
                                                                    obj.ksxs = detail[d]
                                                                }
                                                                if (d == 9) {
                                                                    obj.jxlmc = detail[d]
                                                                }
                                                                if (d == 10) {
                                                                    obj.xf = detail[d]
                                                                }
                                                                if (d == 11) {
                                                                    obj.zongxs = detail[d]
                                                                }
                                                                if (d == 12) {
                                                                    obj.remarks = detail[d]
                                                                }
                                                                obj.status = 0;
                                                            }
                                                            courseArray.push(obj);
                                                        }

                                                        //courseArray就是我们要处理的带状态码的对象数组
                                                        for (var i = 0; i < courseArray.length; i++) {
                                                            var compare = courseArray[i];
                                                            if (compare.status == 0) {
                                                                for (var j = 0; j < courseArray.length; j++) {
                                                                    var compared = courseArray[j];
                                                                    //自己不能和自己比较
                                                                    if (i != j) {
                                                                        //如果除了周次以外的所有信息都相等，就组合
                                                                        if ((compare.croommc == compared.croommc) && (compare.kcmc == compared.kcmc) && (compare.tmc == compared.tmc)) {
                                                                            if (compare.zc != compared.zc) {
                                                                                var zc1 = compare.zc.split("周")[0];
                                                                                var zc2 = compared.zc.split("周")[0];
                                                                                var zc3 = zc1 + "," + zc2;
                                                                                //组合周次，并且排序周次
                                                                                var px = zc3.split(",");
                                                                                var minIndex;
                                                                                var temp;
                                                                                for (var q = 0; q < px.length - 1; q++) {
                                                                                    minIndex = q;
                                                                                    for (var w = q + 1; w < px.length; w++) {
                                                                                        var aaa = parseInt(px[w].split("-")[0]);
                                                                                        var bbb = parseInt(px[minIndex].split("-")[0]);
                                                                                        if (aaa < bbb) {     //寻找最小的数
                                                                                            minIndex = w;                 //将最小数的索引保存
                                                                                        }
                                                                                    }
                                                                                    temp = px[q];
                                                                                    px[q] = px[minIndex];
                                                                                    px[minIndex] = temp;
                                                                                }
                                                                                var finalZc = px[0];
                                                                                for (var z = 1; z < px.length; z++) {
                                                                                    finalZc = finalZc + "," + px[z];
                                                                                }
                                                                                //给比较周次重新赋值，把被比较周次状态设为1
                                                                                courseArray[i].zc = finalZc + "周";
                                                                                courseArray[j].status = 1;
                                                                            }
                                                                        }
                                                                    }
                                                                }
                                                            }
                                                        }
                                                        if (courseArray.length > 0) {
                                                            //现在的courseArray就是最终版了~~~，我们需要重新把值塞到里面
                                                            //先清空该单元格
                                                            $(cell).html("");
                                                            //然后开始重新塞入内容
                                                            for (var aa = 0; aa < courseArray.length; aa++) {
                                                                var oo = courseArray[aa];


                                                                //最后一波骚操作：整合周次
                                                                var realFinalZc = '';
                                                                //console.log("------------------------------------------")
                                                                //console.log("没有处理之前："+oo.zc);
                                                                //标识为改的是重新组合的周次，需要合并，不需要考虑单双周的情况
                                                                if (!isEmpty(oo.zc)) {
                                                                    if (oo.zc.charAt(oo.zc.length - 1) == "改") {
                                                                        var gzcArray = oo.zc.split("周")[0].split(",");
                                                                        //循环开始默认起始周次是第一个周次 '-' 左边的数
                                                                        //循环开始默认结束周次是第一个周次 '-' 右边的数
                                                                        var kaishi = gzcArray[0].split("-")[0];
                                                                        var jieshu = gzcArray[0].split("-")[1];
                                                                        for (var ii = 1; ii < gzcArray.length; ii++) {
                                                                            var qq = parseInt(gzcArray[ii].split("-")[0]);
                                                                            var hh = parseInt(gzcArray[ii - 1].split("-")[1]);
                                                                            //如果ii的前一个数比ii-1的前后一个数大1的话，记录jieshu为ii的后一个数
                                                                            if (hh + 1 == qq) {
                                                                                jieshu = parseInt(gzcArray[ii].split("-")[1]);
                                                                            }
                                                                            //如果不是大1的关系
                                                                            else {
                                                                                //得到起始周次和结束周次,放到最终周次数组里
                                                                                var aaaa = kaishi + "-" + jieshu;
                                                                                if (kaishi == jieshu) {
                                                                                    aaaa = kaishi;
                                                                                }
                                                                                if (realFinalZc == "") {
                                                                                    realFinalZc = realFinalZc + aaaa;
                                                                                } else {
                                                                                    realFinalZc = realFinalZc + "," + aaaa;
                                                                                }
                                                                                //重设起始和结束周次   值为ii的值
                                                                                kaishi = gzcArray[ii].split("-")[0];
                                                                                jieshu = gzcArray[ii].split("-")[1];
                                                                                //如果不是大1的关系，并且是最后一个周次，那么我们就要，直接把ii的值放到最终周次里面
                                                                                // if (ii==gzcArray.length-1){
                                                                                //     if (gzcArray[ii].split("-")[0]==gzcArray[ii].split("-")[1]){
                                                                                //         realFinalZc = realFinalZc+","+gzcArray[ii].split("-")[0];
                                                                                //     }
                                                                                //     else{
                                                                                //         realFinalZc = realFinalZc+","+gzcArray[ii];
                                                                                //     }
                                                                                // }
                                                                            }
                                                                        }
                                                                        if (realFinalZc == "") {
                                                                            realFinalZc = realFinalZc + kaishi + "-" + jieshu;
                                                                        } else {
                                                                            realFinalZc = realFinalZc + "," + kaishi + "-" + jieshu;
                                                                        }
                                                                        realFinalZc = realFinalZc + "周";
                                                                    }
                                                                    //如果标识不为改则需要考虑单双周的情况
                                                                    else {
                                                                        //如果是双周的情况
                                                                        if (oo.zc.indexOf("双") != -1) {
                                                                            var zcqz = oo.zc.split("(双)")[0];
                                                                            var zzcc = zcqz.split(",");
                                                                            //如果只有一个周次
                                                                            if (zzcc.length == 1 && zzcc[0].split("-")[0] == zzcc[0].split("-")[1]) {
                                                                                realFinalZc = zzcc[0].split("-")[0] + "周";
                                                                            }
                                                                            //如果有多个周次，则需要组合
                                                                            else {
                                                                                realFinalZc = oo.zc;
                                                                            }
                                                                        }
                                                                        //如果是单周的情况
                                                                        else if (oo.zc.indexOf("单") != -1) {
                                                                            var zcqz = oo.zc.split("(单)")[0];
                                                                            var zzcc = zcqz.split(",");
                                                                            //如果只有一个周次
                                                                            if (zzcc.length == 1 && zzcc[0].split("-")[0] == zzcc[0].split("-")[1]) {
                                                                                realFinalZc = zzcc[0].split("-")[0] + "周";
                                                                            }
                                                                            //如果有多个周次，则需要组合
                                                                            else {
                                                                                realFinalZc = oo.zc;
                                                                            }
                                                                        }
                                                                        //如果不分单双周
                                                                        else {
                                                                            realFinalZc = oo.zc;
                                                                        }
                                                                    }
                                                                }

                                                                if (realFinalZc.split(",")[0] == "undefined") {
                                                                    realFinalZc = realFinalZc.substring(realFinalZc.indexOf(",") + 1);
                                                                }
                                                                // 对realFinalZc进行处理
                                                                let zcStr = realFinalZc.split('周')[0]
                                                                // 判断单双周得到 str
                                                                let PkglZcstr = PkglZcstrUtils.getByZcstr(zcStr, 1, true)
                                                                realFinalZc = PkglZcstr ? PkglZcstr + '周' : PkglZcstr
                                                                if (oo.status == 0) {
                                                                    var newContent = "";






                                                                    newContent += oo.kcmc + "<br>";


                                                                    newContent += (oo.tmc + ' ');


                                                                    newContent += realFinalZc + "<br>";


                                                                    if (!isEmpty(oo.croommc)) {
                                                                        newContent += oo.croommc + "<br>";
                                                                    }

                                                                    if (isShowJxl && oo.jxlmc) {
                                                                        newContent += oo.jxlmc + "<br>";
                                                                    }

                                                                    if (!isEmpty(oo.jxbmc)) {
                                                                        newContent += oo.jxbmc + "<br>";
                                                                    }

                                                                    if (!isEmpty(oo.remarks)) {
                                                                        newContent += oo.remarks + "<br>";
                                                                    }
                                                                    if ($(cell).html() != '') {
                                                                        $(cell).append("<br>");
                                                                    }
                                                                    if (!isEmpty(oo.ksxs)) {
                                                                        newContent += oo.ksxs + "<br>"
                                                                    }
                                                                    $(cell).append(newContent);
                                                                }
                                                                //console.log("最后结果："+realFinalZc);
                                                                //清空最终周次
                                                                realFinalZc = "";
                                                            }
                                                        }
                                                    }
                                                }
                                            }


                                            for (var i = 0; i <= 7; i++) {
                                                var count = 1;
                                                for (var j = 2; j < 21; j++) {
                                                    var idStr = "#Cell".concat(i, j);
                                                    var idStr2 = "#Cell".concat(i, j - 1);

                                                    //和j-1的元素对比
                                                    if (($(idStr).html() == $(idStr2).html() && $(idStr).html() != "") || ($(idStr).html() == "" && $(idStr2).html() == "" && $(idStr).attr("sid") == $(idStr2).attr("sid"))) {
                                                        count = count + 1;
                                                    } else if (($(idStr).html() != $(idStr2).html() && $(idStr).html() != "") || ($(idStr).html() == "" && $(idStr).attr("sid") != $(idStr2).attr("sid"))) {
                                                        for (var k = j - count + 1; k < j; k++) {
                                                            var idStr3 = "#Cell".concat(i, k);
                                                            $(idStr3).remove();
                                                        }
                                                        var idStr4 = "#Cell".concat(i, j - count);
                                                        $(idStr4).attr("rowspan", count);
                                                        count = 1;
                                                    }


                                                }
                                            }

                                        }
                                        $("td.cell").each(function (index) {
                                            const text = $(this).text();
                                            if (!isEmpty(text)) {
                                                $(this).css("background-color", "#ebf6ff");
                                            }
                                        });
                                    },
                                    error: function (e) {

                                    }
                                });

                            });


                            function exportExcel(title, url, gridId, width, height) {

                                var xnxq = $("#xnxq").val();
                                if (xnxq == "") {
                                    top.layer.alert('请选择学年学期!', { icon: 0, title: '警告' });
                                    return;
                                } else {
                                    var bl = checkKc(xnxq);
                                    if (!bl) {
                                        return false;
                                    }
                                    url = url + "?xnxq=" + xnxq;
                                    if (navigator.userAgent.match(/(iPhone|iPod|Android|ios)/i)) {//如果是移动端，就使用自适应大小弹窗
                                        width = 'auto';
                                        height = 'auto';
                                    } else {//如果是PC端，根据用户设置的width和height显示。
                                        width = '100%';
                                        height = '100%';
                                    }
                                    top.layer.open({
                                        type: 2,
                                        area: [width, height],
                                        title: '打印报表页面',
                                        maxmin: true, //开启最大化最小化按钮
                                        content: url,
                                        success: function (layero, index) {
                                            var body = top.layer.getChildFrame('body', index);
                                            var iframeWin = layero.find('iframe')[0];
                                            iframeWin.contentWindow.setIds('WGEyQ0DB6593E5339A327F2DFAFB7173A79BBC44B15CDCDEB7C726DAA7FEB49D1C125AC200B73B46567C78', '2025-2026学年第1学期王少杰的课表');
                                        },
                                        btn: ['关闭'],
                                        cancel: function (index) {
                                        }
                                    });
                                }

                            }
                            $("#xnxq1").on("change", function () {
                                location.href = '/admin/pkgl/xskb/queryKbForXsd?xnxq=' + $("option:selected", this).val() + '&xskbxslx=' + currentType;
                            });
                            $("#zxzc").on("blur", function () {
                                location.href = '/admin/pkgl/xskb/queryKbForXsd?xnxq=' + $("#xnxq1").val() + '&zxzc=' + $("#zxzc").val() + '&zdzc=' + $("#zdzc").val() + '&xskbxslx=' + currentType;
                            });
                            $("#zdzc").on("blur", function () {
                                location.href = '/admin/pkgl/xskb/queryKbForXsd?xnxq=' + $("#xnxq1").val() + '&zxzc=' + $("#zxzc").val() + '&zdzc=' + $("#zdzc").val() + '&xskbxslx=' + currentType;
                            });

                            $("#zxzc,#zdzc").on('input', function () {
                                let val = $(this).val().replace(/-/g, "");
                                $(this).val(val)
                            })
                            /**
                             * 判断字符串为空
                             */
                            function isEmpty(obj) {
                                if (typeof obj == "undefined" || obj == null || obj == "") {
                                    return true;
                                } else {
                                    return false;
                                }
                            }
                        </script>

                    </div>
                </div>
            </div>
        </div>
    </div>

    <!DOCTYPE html>
    <script src="/static/vendors/bootstrap/js/bootstrap.min.js?_t=1768304087387"></script>
    <!-- Peity -->
    <script src="/static/vendors/peity/jquery.peity.min.js?_t=1768304087387"></script>
    <script src="/static/vendors/layer/layer3.5.1.js?_t=1768304087387"></script>


    <script src="/static/vendors/layer/layer3.5.1.js?_t=1768304087387"></script>
    <!-- jqGrid -->
    <script src="/static/vendors/jqgrid/js/i18n/grid.locale-cn.js?_t=1768304087387"></script>
    <script src="/static/vendors/jqgrid/js/jquery.jqGrid.min.js?_t=1768304087387"></script>
    <script src="/static/vendors/jqgrid/plugins/jquery.tablednd.js?_t=1768304087387"></script>
    <!-- jqGrid curdtools-->
    <script src="/static/common/js/curdtools_jqgrid.js?_t=1768304087387"></script>
    <!-- iCheck -->
    <script src="/static/vendors/iCheck/icheck.min.js?_t=1768304087387"></script>
    <script src="/static/vendors/iCheck/custom.min.js?_t=1768304087387"></script>
    <!-- Sweet alert -->
    <script src="/static/vendors/sweetalert/sweetalert.min.js?_t=1768304087387"></script>
    <!-- 时间控件 -->
    <script src="/static/vendors/datepicker/bootstrap-datepicker.js?_t=1768304087387"></script>

    <input type="hidden" id="adminPath" value="/admin" />
    <input type="hidden" id="staticPath" value="/static" />
    <!-- 自定义js -->
    <script src="/static/common/js/content.js?_t=1768304087387"></script>



</body>

</html>