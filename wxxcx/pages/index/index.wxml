<view class="container">
  
  <!-- 1. Header & Rank Card -->
  <view class="header-section">
    <view class="welcome-text">
       <text class="greeting">Hello, HBUTer ğŸ‘‹</text>
       <text class="sub-greeting">ä½ çš„å­¦ä¸šè¡¨ç°</text>
    </view>

    <!-- Rank Card with Glassmorphism -->
    <view class="rank-card {{showRankCard ? 'expanded' : ''}}" bindtap="toggleRanking">
      <view class="rank-bg"></view> <!-- Gradient BG -->
      <view class="rank-content">
        <view class="rank-header">
           <view class="rank-title">
             <text class="icon">ğŸ“</text>
             <text>æˆ‘çš„æ’å</text>
           </view>
           <view class="action-hint" wx:if="{{!showRankCard}}">
             ç‚¹å‡»æŸ¥çœ‹ <text class="arrow">â–¼</text>
           </view>
        </view>

        <!-- Hidden Details (Slide Down) -->
        <view class="rank-details" wx:if="{{showRankCard}}">
           <view class="gpa-giant">
             <text class="label">å¹³å‡å­¦åˆ†ç»©ç‚¹</text>
             <text class="value">{{rankData.gpa || '--'}}</text>
           </view>
           
           <view class="stats-row">
             <view class="stat-item">
               <text class="stat-label">ä¸“ä¸šæ’å</text>
               <text class="stat-val">{{rankData.major_rank || '--'}}</text>
             </view>
             <view class="stat-line"></view>
             <view class="stat-item">
               <text class="stat-label">ç­çº§æ’å</text>
               <text class="stat-val">{{rankData.class_rank || '--'}}</text>
             </view>
             <view class="stat-line"></view>
             <view class="stat-item">
               <text class="stat-label">ç®—æœ¯å¹³å‡</text>
               <text class="stat-val">{{rankData.avg_score || '--'}}</text>
             </view>
           </view>
        </view>
      </view>
    </view>
  </view>

  <!-- 2. Course List (Grouped by Semester) -->
  <scroll-view scroll-y class="course-list-container">
    <block wx:for="{{semesterGroups}}" wx:key="semesterName" wx:for-item="group">
      <view class="semester-section">
        <view class="semester-header">
          <text class="semester-title">{{group.semesterName}}</text>
          <text class="semester-count">{{group.courses.length}} é—¨è¯¾ç¨‹</text>
        </view>
        
        <view class="course-grid">
          <block wx:for="{{group.courses}}" wx:key="course_name" wx:for-item="course">
            <view class="course-card {{course.isFail ? 'fail-card' : ''}}">
              <view class="card-top">
                <text class="course-name">{{course.course_name}}</text>
                <text class="course-score {{course.isFail ? 'fail-text' : ''}}">{{course.score}}</text>
              </view>
              <view class="card-bottom">
                <view class="tag-row">
                   <text class="tag {{course.type === 'å¿…ä¿®' ? 'tag-primary' : 'tag-default'}}">{{course.type}}</text>
                   <text class="tag tag-credit">{{course.credit}} å­¦åˆ†</text>
                </view>
              </view>
            </view>
          </block>
        </view>
      </view>
    </block>
    
    <!-- Empty State -->
    <view wx:if="{{semesterGroups.length === 0}}" class="empty-state">
      <image src="/assets/empty.png" mode="widthFix" class="empty-img"></image>
      <text>åŠ è½½ä¸­æˆ–æš‚æ— æ•°æ®...</text>
    </view>
    
    <view class="footer-spacing"></view>
  </scroll-view>

</view>
